<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel</title>
    <style>
        .category-section { margin: 20px; padding: 15px; border: 1px solid #ccc; }
        .product-item { margin: 10px; padding: 10px; background: #f5f5f5; }
    </style>
</head>
<body>
    <h1>Panel de Administración</h1>
    <div id="categories-container"></div>
    <button onclick="saveChanges()">Guardar Cambios</button>

    <script>
        let currentData = {};
        
        // Cargar datos iniciales
        fetch('/Admin/JSON/json-general.json')
            .then(res => res.json())
            .then(data => {
                currentData = data;
                renderCategories();
            });

        function renderCategories() {
            const container = document.getElementById('categories-container');
            container.innerHTML = '';

            Object.entries(currentData.categories).forEach(([categoryName, categoryData]) => {
                const categorySection = document.createElement('div');
                categorySection.className = 'category-section';
                
                // Toggle para categoría
                categorySection.innerHTML = `
                    <h2>
                        <input type="checkbox" ${categoryData.visible ? 'checked' : ''} 
                            onchange="toggleCategoryVisibility('${categoryName}', this.checked)">
                        ${categoryName.toUpperCase()}
                    </h2>
                    <div class="products-container" id="${categoryName}-products"></div>
                `;

                // Renderizar productos
                const productsContainer = categorySection.querySelector(`#${categoryName}-products`);
                categoryData.products.forEach((product, index) => {
                    const productDiv = document.createElement('div');
                    productDiv.className = 'product-item';
                    productDiv.innerHTML = `
                        <input type="checkbox" ${product.visible ? 'checked' : ''} 
                            onchange="toggleProductVisibility('${categoryName}', ${index}, this.checked)">
                        ${product.title}
                    `;
                    productsContainer.appendChild(productDiv);
                });

                container.appendChild(categorySection);
            });
        }

        function toggleCategoryVisibility(categoryName, isVisible) {
            currentData.categories[categoryName].visible = isVisible;
        }

        function toggleProductVisibility(categoryName, productIndex, isVisible) {
            currentData.categories[categoryName].products[productIndex].visible = isVisible;
        }

        function saveChanges() {
            // Aquí necesitarías implementar la lógica para guardar en el servidor
            // Esto es un ejemplo básico usando localStorage como temporal
            localStorage.setItem('productsData', JSON.stringify(currentData));
            alert('Cambios guardados temporalmente (necesitarás implementar el guardado en servidor)');
        }
    </script>
</body>
</html>